class LessonPlayerFunctions{scrollPercentSetup(o){let a=0,i=0;var r=$(".page-content");LessonPlayerFunctions.scrollHandler=function(){if(50<i){var e=null!=(e=null==(e=$(r))?void 0:e.prop("scrollHeight"))?e:1;let t=0;$(".content-block-list.collapse:not(.show)",r).each(function(){var e;t+=null!=(e=$(this).outerHeight())?e:0}),e+t>a&&(a=e+t);var e=null!=(e=null==(e=$(r))?void 0:e.height())?e:0,n=100*(null!=(n=null==(n=$(r))?void 0:n.scrollTop())?n:0)/(a-e);o.invokeMethodAsync("UpdateLessonProgressBar",n),i=0}},r.on("scroll",LessonPlayerFunctions.scrollHandler),setInterval(function(){i+=10},10)}scrollPercentDispose(){$(".page-content").off("scroll",LessonPlayerFunctions.scrollHandler),LessonPlayerFunctions.scrollHandler=null}}class TestPlayerFunctions{setupCopyProtection(n){TestPlayerFunctions.contextMenuHandler=function(e){e.preventDefault()},document.addEventListener("contextmenu",TestPlayerFunctions.contextMenuHandler),TestPlayerFunctions.selectStartHandler=function(e){e.preventDefault()},document.addEventListener("selectstart",TestPlayerFunctions.selectStartHandler),TestPlayerFunctions.copyHandler=function(e){e.preventDefault()},document.addEventListener("copy",TestPlayerFunctions.copyHandler),TestPlayerFunctions.keydownHandler=function(e){var t=e.key.toLowerCase();(e.ctrlKey&&-1!==["c","u","s"].indexOf(t)||e.ctrlKey&&e.shiftKey&&-1!==["i","j"].indexOf(t)||"f12"===t)&&(e.preventDefault(),n.invokeMethodAsync("OnDevToolsAttempt"))},document.addEventListener("keydown",TestPlayerFunctions.keydownHandler)}disposeCopyProtection(){document.removeEventListener("contextmenu",TestPlayerFunctions.contextMenuHandler),document.removeEventListener("selectstart",TestPlayerFunctions.selectStartHandler),document.removeEventListener("copy",TestPlayerFunctions.copyHandler),document.removeEventListener("keydown",TestPlayerFunctions.keydownHandler),TestPlayerFunctions.contextMenuHandler=null,TestPlayerFunctions.selectStartHandler=null,TestPlayerFunctions.copyHandler=null,TestPlayerFunctions.keydownHandler=null}}window.HELP_IMPROVE_VIDEOJS=!1,window.VIDEOJS_NO_DYNAMIC_STYLE=!0;var subsCapsButton=videojs.getComponent("SubsCapsButton");class SubtitlesCaptionsButton extends subsCapsButton{constructor(e,t){super(e,t),this.controlText("Subtitles"),this.addClass("vjs-captions-button"),this.hide()}createMenu(){var e=super.createMenu();return e.addClass("subtitles-menu"),e}createItems(){var e=super.createItems();return e.forEach(e=>{var t,n,o=e.track.label||e.track.language,a=null==(a=e.track.language)?void 0:a.split("-")[0].toLowerCase();a&&((t=document.createElement("span")).classList.add("vjs-radio-icon-container"),(n=document.createElement("span")).classList.add("vjs-radio-icon"),t.appendChild(n),(n=document.createElement("img")).src=`/images/flag-${a}.svg`,n.classList.add("vjs-flag-icon"),(a=document.createElement("span")).classList.add("vjs-label-text"),a.textContent=o,(o=e.el()).textContent="",o.appendChild(t),o.appendChild(n),o.appendChild(a))}),e}updateIcon(e){this.el().querySelector(".vjs-icon-placeholder").innerHTML='<svg class="svg-icon icon-closed-caption" role="presentation" aria-hidden="true"><use xlink:href="#icon-closed-caption"></use></svg>'}}function videoPlayerIcons(){$.each({BigPlayButton:["play"],PlayToggle:["play","pause"],VolumePanel:["volume-2"],FullscreenToggle:["maximize-2","minimize-2"]},function(e,o){let a=videojs.getComponent(e);class t extends a{constructor(e,t){super(e,t);new a(e,t);let n="";$.each(o,function(){n+=`<svg class="svg-icon icon-${this}" role="presentation" aria-hidden="true"><use xlink:href="#icon-${this}"></use></svg>`}),this.el().querySelector(".vjs-icon-placeholder").innerHTML=n}}videojs.registerComponent(e,t)})}function videoPlayerSetup(a,i,e,n,o,t,r,s,l){var d={textTrackSettings:!1,playbackRates:[.5,1,1.25,1.5,1.75,2],controlBar:{children:["progressControl","playToggle","currentTimeDisplay","timeDivider","durationDisplay","playbackRateMenuButton","SubsCapsButton","volumePanel","fullscreenToggle"]}};function c(){var e,t=m.currentTime();null==E&&(e=null==(e=a.parentElement)?void 0:e.querySelector(".vjs-load-progress"))&&((E=document.createElement("div")).classList.add("vjs-max-seek"),e.after(E),k(0)),m.seeking()||k(t),f||void 0!==(e=m.duration())&&0<e&&t>=e-Math.min(30,.1*e)&&!f&&(f=!0,w())}function u(){var e,t,n=m.error();n&&(t={1:{type:"MEDIA_ERR_ABORTED",heading:"The video load was cancelled",body:null},2:{type:"MEDIA_ERR_NETWORK",heading:"The video connection was lost",body:null},3:{type:"MEDIA_ERR_DECODE",heading:"The video cannot be played",body:"Your browser does not support the video format"},4:{type:"MEDIA_ERR_SRC_NOT_SUPPORTED",heading:"The video could not be loaded",body:null},5:{type:"MEDIA_ERR_ENCRYPTED",heading:"The video could not be decrypted",body:null},unknown:{type:"MEDIA_ERR_UNKNOWN",heading:"An unknown error occurred",body:"Please refresh and try again"},"-1":{type:"PLAYER_ERR_NO_SRC",heading:"The video was not found",body:null},"-2":{type:"PLAYER_ERR_TIMEOUT",heading:"Could not download the video",body:null},PLAYER_ERR_DOMAIN_RESTRICTED:{type:"PLAYER_ERR_DOMAIN_RESTRICTED",heading:"The video could not be loaded",body:"Domain restrictions prevent playback"},PLAYER_ERR_IP_RESTRICTED:{type:"PLAYER_ERR_IP_RESTRICTED",heading:"The video could not be loaded",body:"IP restrictions prevent playback"},PLAYER_ERR_GEO_RESTRICTED:{type:"PLAYER_ERR_GEO_RESTRICTED",heading:"The video could not be loaded",body:"Geo restrictions prevent playback"},FLASHLS_ERR_CROSS_DOMAIN:{type:"FLASHLS_ERR_CROSS_DOMAIN",heading:"The video could not be loaded",body:"Cross domain restrictions prevent playback"}},e=$(null==(e=m.getChild("errorDisplay"))?void 0:e.el()))&&(n=t[n.code.toString()]||t.unknown,(t=$('<div class="vjs-error-message"></div>')).append($(".video-js-error-icon:first").html()),t.append($('<p class="vjs-error-heading"></p>').text(n.heading)),n.body&&t.append($('<p class="vjs-error-body"></p>').text(n.body)),(n=$(".vjs-error-message",e)).length&&n.remove(),e.append(t))}function p(){m.paused()||R(),m.off("contextmenu"),m.off("dispose",p),m.off("ended",h),m.off("seeked",_),m.off("seeking",x),m.off("play",S),m.off("pause",R),m.off("firstplay",L),m.off("loadedmetadata",A),m.off("timeupdate",c),m.off(["aderror","contenterror","error"],u),$(window).off("beforeunload",v),P.disconnect()}function v(){m.paused()||R()}function h(){w()}let f=n,m=(t&&(d.playbackRates=null,d.controlBar.children.splice(5,1)),videojs(a,d)),y="video/youtube"===m.currentType(),g=e,T=0,b=0,E=null,k=function(e){var t=m.duration();n&&t?g=t:void 0!==e&&e>g&&(g=e),E&&t&&(E.style.width=g/t*100+"%")},C=(m.ready(function(){var e=m.controlBar.getChild("SubsCapsButton"),t=m.textTracks();if(e){if("function"==typeof e.createItems){var n=e.createItems();let t=e.menu;t&&void 0!==t.children_&&(t.children_.length=0,n.forEach(e=>t.addItem(e)))}n=Array.from(t).find(e=>"captions"===e.kind&&"showing"===e.mode);e.updateIcon(n)}if(s?addSubtitlesTracks(a,l,r):removeSubtitlesTracks(a),r)for(let e=0;e<t.length;e++){var o=t[e];"captions"===o.kind&&o.language===r?o.mode="showing":o.mode="disabled"}}),m.on("texttrackchange",function(){let t=!1;var n=m.textTracks();for(let e=0;e<n.length;e++)if("captions"===n[e].kind){t=!0;break}var e=Array.from(n).find(e=>"captions"===e.kind&&"showing"===e.mode),o=m.controlBar.getChild("SubsCapsButton");o&&(t?o.show():o.hide(),o.updateIcon(!!e)),e&&e.language?i.invokeMethodAsync("OnSubtitleLanguageChanged",e.language):i.invokeMethodAsync("OnSubtitleLanguageChanged",null)}),function(){return!o||m.duration()-e<1?0:e}),R=function(){var e=(b=(new Date).getTime())-T;0<e&&i.invokeMethodAsync("OnPaused",e,m.currentTime())},P=new MutationObserver(function(e,t){for(var n of e){var n=n.target,o=n.getAttribute("title");o&&(n.setAttribute("data-bs-original-title",o),n.removeAttribute("title"))}});function w(){y&&R(),i.invokeMethodAsync("OnEnded")}function _(){var e=m.currentTime();i.invokeMethodAsync("OnSeeked",e)}function x(){t&&m.currentTime()>g&&m.currentTime(g)}function S(){T=b=(new Date).getTime(),videoPlayerPauseOthers(a)}function A(){let t,n=m.duration();if(o){let e=document.createElement("progress");e.className="vjs-progress",e.setAttribute("value","0"),e.setAttribute("max","100"),null!=(t=m.getChild("posterImage"))&&t.el().append(e),y||L(),setTimeout(function(){e.setAttribute("value",(100*C()/n).toFixed(2))},300)}i.invokeMethodAsync("OnVideoDurationLoaded",n)}let L=function(){m.currentTime(C())};m.on("contextmenu",function(e){return e.preventDefault(),e.stopPropagation(),!1}),m.on("ratechange",function(e){t&&1!=m.playbackRate()&&m.playbackRate(1)}),m.on(["aderror","contenterror","error"],u),m.on("dispose",p),m.on("ended",h),m.on("seeking",x),m.on("seeked",_),m.on("play",S),m.on("timeupdate",c),m.on("pause",R),m.on("loadedmetadata",A),$(window).on("beforeunload",v);var I=m.controlBar.children();for(let t=0;t<I.length;t++){var D=I[t].el();let e=null;D.title&&0<D.title.length?e=D:(D=D.querySelector("button"))&&D.title&&0<D.title.length&&(e=D),e&&(window.BootstrapFunctions.tooltip(e),$(e).on("click",function(){this.blur()}),P.observe(e,{attributeFilter:["title"]}))}e&&y&&m.on("firstplay",L)}function dispose(e){e=videojs(e);null!=e&&e.dispose()}function posterChanged(e,t){var n=videojs(e);0!==$(e).parent().find("div.video-loading").length&&$(e).parent().find("div.video-loading").remove(),n.poster(t)}function addSubtitlesTracks(e,t,n){let o=videojs(e);var a=o.remoteTextTracks();for(let e=a.length-1;0<=e;e--)o.removeRemoteTextTrack(a[e]);t.filter(e=>e.transcriptFile).forEach(e=>{var t=e.language===n;o.addRemoteTextTrack({kind:"captions",src:e.url,srclang:e.language,label:`${e.languageName} (${null==(e=e.language)?void 0:e.split("-")[0].toUpperCase()})`+(t?" - Default":""),mode:t?"showing":"disabled"},!1)})}function refreshSubtitlesTrack(e,t,n=null){var o,a=videojs(e);if(t&&0!==t.length){var i,r,s=a.remoteTextTracks();for(let e=s.length-1;0<=e;e--)a.removeRemoteTextTrack(s[e]);for(i of t)i&&i.transcriptFile&&i.url&&(r=i.language===n,a.addRemoteTextTrack({kind:"captions",src:i.url,srclang:i.language,label:`${i.languageName} (${null==(o=i.language)?void 0:o.split("-")[0].toUpperCase()})`+(r?" - Default":""),mode:r?"showing":"disabled"},!1))}}function removeSubtitlesTracks(e){var t=videojs(e),n=t.remoteTextTracks();for(let e=n.length-1;0<=e;e--)t.removeRemoteTextTrack(n[e])}function showLoading(e,t){$(e).parent().append('<div class="video-loading"><svg class="svg-icon icon-loader-circle"><use xlink:href="#icon-loader-circle"></use></svg></div>'),t&&($(t).parent().children().removeClass("video-thumbnail-selected"),$(t).addClass("video-thumbnail-selected"))}function videoPlayerPauseOthers(o){$(".video-js").each(function(e,t){var t=t.player,n=t.children("video")[0];o!=n&&t.pause()})}function videoPlayerPauseAll(){document.querySelectorAll("video").forEach(function(e){e.pause()})}videojs.registerComponent("SubsCapsButton",SubtitlesCaptionsButton),videoPlayerIcons();class ContentBlockFunctions{onEditModeEnter(e,t){try{e.scrollIntoView({behavior:"smooth",block:t,inline:"nearest"})}catch(e){}}scrollBarWidthInit(){this.updateScrollbarOffset();var e=document.getElementById("main-content");e&&new ResizeObserver(this.updateScrollbarOffset).observe(e)}updateScrollbarOffset(){var e,t=document.getElementById("main-content");t&&(e=t.offsetWidth-t.clientWidth,t.style.setProperty("--scrollbar-offset",e+"px"))}}class QuizBlockFunctions{quizSetup(e,n){$(e).on("animationend",(e,t)=>n.invokeMethodAsync("QuestionAnimationEnd"))}animateMatchFields(e){$(".match-fields-description").addClass("demo"),setTimeout(()=>{$(".match-fields-description").removeClass("demo")},2e3),window.innerWidth<=576&&($(".choices-column .item").each(function(){var e=$(this);$(e).addClass("demo"),setTimeout(()=>{$(e).removeClass("demo")},2e3)}),$(".matches-column .item").each(function(){var e=$(this);$(e).addClass("demo"),setTimeout(()=>{$(e).removeClass("demo")},2e3)}))}resetTextBoxWidth(e,t){t=$(t);null!=t&&$(e).text(""+t.val())}initializeTextFieldEvents(e,t){$(e).on("input",e=>t.invokeMethodAsync("OnInput",e.target.value))}disableSelectionAndCopy(e){$(e).on("selectstart copy",e=>e.preventDefault())}}var __awaiter=this&&this.__awaiter||function(e,r,s,l){return new(s=s||Promise)(function(n,t){function o(e){try{i(l.next(e))}catch(e){t(e)}}function a(e){try{i(l.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,a)}i((l=l.apply(e,r||[])).next())})};class AIChatFunctions{createAIChatTextArea(t,n){let e,o=()=>__awaiter(this,void 0,void 0,function*(){(yield n.invokeMethodAsync("OnSubmitInternal"))&&(t.textContent="",t.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})))});t.addEventListener("keydown",e=>__awaiter(this,void 0,void 0,function*(){if("Enter"===e.key&&!e.shiftKey)return e.preventDefault(),e.stopPropagation(),yield o(),!1}));var a=e=>{t.textContent||(t.textContent=""),n.invokeMethodAsync("OnInputInternal",t.textContent)},a=(t.addEventListener("input",a),t.addEventListener("blur",a),t.addEventListener("paste",e=>{e.preventDefault();var t="",n=window;e.clipboardData?t=e.clipboardData.getData("text/plain").replace(/\r?\n|\r/g," ").trim():n.clipboardData&&(t=n.clipboardData.getData("Text").trim()),document.queryCommandSupported("insertText")?document.execCommand("insertText",!1,t):document.execCommand("paste",!1,t)}),null==(e=t.closest(".ai-prompt-textarea-container"))?void 0:e.getElementsByClassName("ai-chat-send-btn")[0]);a&&a.addEventListener("click",e=>__awaiter(this,void 0,void 0,function*(){yield o()}))}createAIChatMessagesContainer(t){new MutationObserver(e=>{e.every(e=>null==(e=e.target)?void 0:e.classList.contains("ai-message-action-btn"))||(t.scrollTop=t.scrollHeight)}).observe(t,{childList:!0,subtree:!0}),t.scrollTop=t.scrollHeight}createAIChatMessage(e){e.addEventListener("animationend",()=>{e.classList.remove("created")})}}function LoadInterop(){var e=window;e.LessonPlayerFunctions=new LessonPlayerFunctions,e.TestPlayerFunctions=new TestPlayerFunctions,e.ContentBlockFunctions=new ContentBlockFunctions,e.QuizBlockFunctions=new QuizBlockFunctions,e.AIChatFunctions=new AIChatFunctions}LoadInterop();